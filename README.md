# hibernateCourse
https://www.udemy.com/course/hibernate-kurs/

Practical exercises with hibernate framework

   ### Конфигурация
   
   Конфигурировать hibernate можно несколькими способами
   
   - Xml файл
        
      В ресурсах создать файл hibernate.cfg.xml(по умолчанию) и с его помощю провести конфигурацию.
   - .property файл
   
      В ресурсах создать файл hibernate.properties и с его помощью проводить конфигурацию.
      
   - java файл
   - VM options
   
   ### Настройка маппинга объектов
   
Настроить маппинг объектов в таблицы бд можно двумя способами:
- аннотации
    
Класс помечается аннотацией `@Entity`
Одно из полей класса должно быть помечено аннотацией `@Id`
   
    
- xml файл
   
   Миннимальный приммер настройки xml маппинга в файле [Person.cfg.xml](src/main/resources/entities/Person.hbm.xml).
   
   При этом необходимо в конфиг файле создать секцию `mapping` 
   и указать ссылку на конфигурацию маппнига конкретного класса. Для
   каждого класса создается своя секция `mapping`
   
   Пример
   
   ```<mapping resource="entities/Person.hbm.xml"/>```
   

В каждом классе, помеченном аннотацией `@Entity` обязательно должно быть поле, помеченное аннотацией `@Id`

Для автоматической генерации id существует аннотация `@GeneratedValue`. Задать стратегию генерации 
id можно через параметр аннотации `@GeneratedValue(strategy = GenerationType.*****)`. По умолчанию 
`GenerationType.AUTO`. 
   
   - `GenerationType.AUTO` говорит о том, что каждый провайдер сам выбирает стратегию генерации id
   - `GenerationType.IDENTITY` - работает с базами, у которых есть специальные IDENTITY поля, например с MySQL или DB2.
   - `GenerationType.SEQUENCE` - использует встроенный в базы данных, такие как PostgreSQL или Oracle, механизм генерации последовательных значений (sequence)
   - `GenerationType.TABLE` - не зависит от поддержки конкретной базой данных и хранит счётчики значений в отдельной таблице. С одной стороны это более гибкое и настраиваемое решение, с другой стороны более медленное и требующее большей настройки.
   
   
   ###Отношения между объектами приложения
   
   - One to one
   
   Записи в таблицах бд будут связаны одна к одной. 
  
    @Entity
    public class Person {
     @Id
     @GeneratedValue(strategy = GenerationType.AUTO)
     private int id;
 
     @Column(name = "first_name")
     private String firstName;
 
     @OneToOne
     private Address address;
 
     public Person() {
     } 
     
     
     @Entity
     public class Address {
         @Id
         @GeneratedValue
         private int id;
     
         private String streetName;
     
         public Address() {
         }
         
В этом случае, будет созданны две таблицы в бд(`person` и `address`). Таблица `address` будет 
содержать поле с ид и текстовым полем, хранящим название улицы. Таблица `person` будет содердать 
информацию о персоне и id улицы из таблицы `address`.

Аннотация `OneToOne` имеет несколько параметров: 
   1) `cascade = CascadeType.` Задается тип операций, которые будут распространяться и на связанный объект.
   
   2) `fetch = FetchType.` Позволяет отложить получение реальных данных из бд, 
   до того момента, когда эти данные потребуются.
   
   3) `optional = true/false` Может ли существовать одна запись без другой. Если true, то можно
   создать `person` с нулевым полем address.
   
   4) `orphanRemoval = true/false` Оставлять или удалять сирот. Если `orphanRemoval = true`, то 
   при удалении записи `person` будет удалена и соответствующая ей запись `address`.
   
   5) `mappedBy = "person"` При двунаправленом взаимоотношении, можно указать хозяина отношений.
   В этом случае, хозяин отношений `address` и в нем будет хранится `id` персоны из
    таблицы `person`.
   В свою очередь, запись в таблице `person` не будет хранить `id` адреса `address`, которой, 
   по сути, принадлежит эта запись. Таким образом устраняется дублирование информации при
   двунаправленном взаимоотношении.
   
   Отношения между классами могут быть:
   1) unidirectional(однонаправленные) - первый клаз знает о втором. Второй не знает о первом.
   2) bidirectional(двунаправленные) - оба класса знают о друг друге.
   - One to many
   
   - Many to one
   
   - Many to many
   
   
   